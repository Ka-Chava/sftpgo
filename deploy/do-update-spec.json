{
  "name": "kca-sftpgo",
  "region": "nyc",
  "databases": [
    { "name": "db-sftpgo", "engine": "PG", "version": "17" }
  ],
  "services": [
    {
      "name": "sftpgo",
      "github": { "repo": "Ka-Chava/sftpgo", "branch": "main", "deploy_on_push": true },
      "dockerfile_path": "/Dockerfile",
      "source_dir": "/",
      "http_port": 8080,
      "instance_count": 1,
      "instance_size_slug": "apps-s-1vcpu-1gb",
      "envs": [
        { "key": "SFTPGO_HTTPD__BINDINGS__0__PORT", "value": "8080", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__SECURITY__ENABLED", "value": "true", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__SECURITY__HTTPS_PROXY_HEADERS__0__KEY", "value": "X-Forwarded-Proto", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__SECURITY__HTTPS_PROXY_HEADERS__0__VALUE", "value": "https", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__SECURITY__HOSTS_PROXY_HEADERS__0", "value": "X-Forwarded-Host", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__SECURITY__ALLOWED_HOSTS__0", "value": "sftp.kachava.com", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__SECURITY__ALLOWED_HOSTS__1", "value": "sftpgo.kachava.com", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__BASE_URL", "value": "https://sftp.kachava.com", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__SECURITY__HTTPS_REDIRECT", "value": "false", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__CLIENT_IP_PROXY_HEADER", "value": "CF-Connecting-IP", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__CLIENT_IP_HEADER_DEPTH", "value": "0", "scope": "RUN_TIME" },
        { "key": "SFTPGO_HTTPD__BINDINGS__0__PROXY_ALLOWED__0", "value": "0.0.0.0/0", "scope": "RUN_TIME" },
        { "key": "SFTPGO_DATA_PROVIDER__DRIVER", "value": "postgresql", "scope": "RUN_TIME" },
        { "key": "SFTPGO_DATA_PROVIDER__CONNECTION_STRING", "value": "${db-sftpgo.DATABASE_URL}", "scope": "RUN_TIME" }
      ]
    }
  ],
  "domains": [{ "domain": "sftp.kachava.com", "type": "PRIMARY" }],
  "alerts": [{ "rule": "DEPLOYMENT_FAILED" }, { "rule": "DOMAIN_FAILED" }],
  "ingress": {
    "rules": [
      {
        "match": { "path": { "prefix": "/" }, "authority": {} },
        "component": { "name": "sftpgo" }
      }
    ]
  },
  "features": ["buildpack-stack=ubuntu-22"],
  "disable_edge_cache": true
}
